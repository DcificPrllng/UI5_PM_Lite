<mvc:View class="sapUiSizeCompact" xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m"
	xmlns:html="http://www.w3.org/1999/xhtml" xmlns:table="sap.ui.table" xmlns:f="sap.ui.layout.form" busyIndicatorDelay="0"
	controllerName="pd.pm.lite.controller.ChangeOrder">
	<App>
		<pages>
			<Page title="{jsonModel>/WorkOrderDetail/OrderNumber}: {jsonModel>/WorkOrderDetail/ShortDescription}" showHeader="false" class="cisLabels">
				<content>
					<HBox justifyContent="Center" height="100%">
						<VBox width="90%" height="100%" direction="Column" alignContent="Center" alignItems="Center">
							<FlexBox height="16%" width="100%" direction="Column" class="PDHeader sapUiTinyMargin">
								<!--//First Row-->
								<FlexBox width="100%" class="sapUiTinyMarginBegin" justifyContent="Start">
									<Button class="sapUiTinyMarginBegin cisUiTinyMarginBegin" type="Default" id="release" icon="sap-icon://flag" width="90px" text="{i18n>Release}" press=".ReleaseOrder"/>
									<Button class="sapUiTinyMarginBegin" type="Accept" id="save" icon="sap-icon://save" width="95px" text="{i18n>Save}" press=".SaveOrder"/>
									<Button class="sapUiTinyMarginBegin" type="Reject" id="cancel" icon="sap-icon://cancel" width="95px" text="{i18n>Cancel}" press=".GoHome"/>
								</FlexBox>
								<FlexBox width="100%" class="cisUiTinyMargin" justifyContent="Start">
									<Label width="104px" class="cisTopMargin" textAlign="Right" text="{i18n>Order}" design="Bold"/>
									<Input width="80px" class="sapUiTinyMarginBegin cisDisbaledInput" enabled="false" value="{path: 'jsonModel>/WorkOrderDetail/OrderType'}"/>
									<Input width="120px" enabled="false" class="cisDisbaledInput"
										value="{path: 'jsonModel>/WorkOrderDetail/OrderNumber', formatter: '.formatter.removeLeadingZerosFromString'}"/>
									<Input width="400px" value="{path: 'jsonModel>/WorkOrderDetail/ShortDescription', type : 'pd.pm.lite.customTypes.Mandatory'}" maxLength="40"/>
									<Label class="sapUiTinyMarginBegin cisTopMargin" width="208px" textAlign="Right" text="{i18n>SystemStatus}" design="Bold"/>
									<Input width="308px" enabled="false" class="sapUiTinyMarginBegin cisDisbaledInput" value ="{jsonModel>/WorkOrderDetail/SystemStatus}"/>
									<Input width="300px" enabled="false" class="cisDisbaledInput" value="{path: 'jsonModel>/WorkOrderDetail/UserStatus'}"/>
									<core:Icon src="sap-icon://user-edit" class="sapUiTinyMarginBegin" press="showUserStatusValueHelp"/>
								</FlexBox>
								<!--//Second Row-->
								<FlexBox width="100%" class="cisUiTinyMargin" justifyContent="Start">
									<Label width="104px" textAlign="Right" text="{i18n>MainWorkCenter}" class="cisLabels cisTopMargin" design="Bold" required="true"/>
									<ComboBox class="sapUiTinyMarginBegin" id="workCenterId" items="{localStorageModel>/WorkCenters}" showSecondaryValues="false"
										selectedKey="{path:'jsonModel>/WorkOrderDetail/MainWorkCenter', type : 'pd.pm.lite.customTypes.Mandatory'}" width="200px">
										<items>
											<core:ListItem text="{localStorageModel>Id} ({localStorageModel>Name})" key="{localStorageModel>Id}"
												additionalText="{localStorageModel>Name}"></core:ListItem>
										</items>
									</ComboBox>
									<Label width="104px" textAlign="Right" text="{i18n>FunLoc}" design="Bold" class="cisLabels cisTopMargin"/>
									<Label width="400px"
										text="{parts:[{path: 'jsonModel>/WorkOrderDetail/FunctionalLocation'}, {path: 'jsonModel>/WorkOrderDetail/FunctionalLocationName'}], formatter: '.formatter.commonIDFormatter'}"
										class="sapUiTinyMarginBegin cisLabels cisTopMargin" design="Bold"/>
									<Label width="104px" textAlign="Right" text="{i18n>ReportedBy}" design="Bold" class="cisLabels cisTopMargin"/>
									<Input width="195px" enabled="false" class="sapUiTinyMarginBegin cisDisbaledInput" value ="{jsonModel>/WorkOrderDetail/ReportedBy}"/>
									<!--<Label width="195px" text="{jsonModel>/WorkOrderDetail/ReportedBy}" design="Bold" class="sapUiTinyMarginBegin cisLabels cisTopMargin"/>-->
									<Label width="104px" textAlign="Right" text="{i18n>BasicStart}" design="Bold" class="cisLabels cisTopMargin"/>
									<DatePicker width="124px" enabled="{path: 'jsonModel>/WorkOrderDetail/SystemStatus', formatter:'.formatter.BasicDateEditable'}" dateValue="{path:'jsonModel>/WorkOrderDetail/BasicStart'}" class="sapUiTinyMarginBegin cisDisbaledInput"/>
									<Label width="104px" textAlign="Right" text="{i18n>SchStart}" design="Bold" class="cisLabels cisTopMargin"/>
									<Label width="84px" text="{path:'jsonModel>/WorkOrderDetail/ScheduledStart', formatter:'.formatter.date'}" class="sapUiTinyMarginBegin cisLabels cisTopMargin"
										design="Bold"/>
								</FlexBox>
								<!--//Third Row-->
								<FlexBox width="100%" class="cisUiTinyMargin" justifyContent="Start">
									<Label width="104px" textAlign="Right" text="{i18n>PMActType}" design="Bold" class="cisTopMargin cisLabels" required="true"/>
									<ComboBox width="200px" items="{jsonModel>/ActivityTypes}"
										selectedKey="{path:'jsonModel>/WorkOrderDetail/PmActivityType', type : 'pd.pm.lite.customTypes.Mandatory'}"
										class="sapUiTinyMarginBegin">
										<items>
											<core:ListItem text="{jsonModel>Code} ({jsonModel>Name})" key="{jsonModel>Code}" additionalText="{jsonModel>Name}"/>
										</items>
									</ComboBox>									
									<Label width="104px" textAlign="Right" text="{i18n>Equipment}" design="Bold" class="cisLabels cisTopMargin"/>
									<Label width="400px" design="Bold"
										text="{parts:[{path:'jsonModel>/WorkOrderDetail/Equipment'}, {path: 'jsonModel>/WorkOrderDetail/EquipmentName'}], formatter:'.formatter.equipment'}"
										class="sapUiTinyMarginBegin cisLabels cisTopMargin"/>
									<Label width="104px" textAlign="Right" text="{i18n>Priority}" design="Bold" class="cisLabels cisTopMargin" required="true"/>									
									<ComboBox width="195px" enabled="{path: 'jsonModel>/WorkOrderDetail/SystemStatus', formatter:'.formatter.PriorityEditable'}" selectedKey="{path:'jsonModel>/WorkOrderDetail/Priority'}"
										class="sapUiTinyMarginBegin cisDisbaledInput">
										<items>
											<core:ListItem text="" key=""/>
											<core:ListItem text="SAFE CRIT (&lt;30 DAY)" key="1"/>
											<core:ListItem text="OPS CRIT (&lt;30 DAY)" key="2"/>
											<core:ListItem text="TIME SENS (&lt;60 DAY)" key="3"/>
											<core:ListItem text="NON CRIT (&lt;180 DAY)" key="4"/>
										</items>
									</ComboBox>									
									<Label width="104px" textAlign="Right" text="{i18n>BasicFinish}" design="Bold" class="cisLabels cisTopMargin"/>
									<DatePicker enabled="{path: 'jsonModel>/WorkOrderDetail/SystemStatus', formatter:'.formatter.BasicDateEditable'}" width="124px" dateValue="{path:'jsonModel>/WorkOrderDetail/BasicFinish'}" class="sapUiTinyMarginBegin cisDisbaledInput"/>									
									<Label width="104px" textAlign="Right" text="{i18n>SchFinish}" design="Bold" class="cisLabels cisTopMargin"/>
									<Label width="84px" text="{path:'jsonModel>/WorkOrderDetail/ScheduledFinish', formatter:'.formatter.date'}" class="cisLabels cisTopMargin sapUiTinyMarginBegin"
										design="Bold"/>
								</FlexBox>
							</FlexBox>
							<HBox height="84%" justifyContent="Center">
								<VBox height="98%" width="60%" justifyContent="SpaceBetween">
									<VBox height="50%" justifyContent="Start">
										<table:Table id="OperationsTable" rows="{path:'jsonModel>/Operations', templateShareable:false}" selectionMode="MultiToggle"
											visibleRowCountMode="Auto" minAutoRowCount="9" class="sapUiTinyMarginBegin">
											<table:toolbar>
												<Toolbar class="cisTableHeader">
													<content>
														<Button class="cisHeadingButton" width="100px" text="{i18n>Operations}"/>
														<Button type="Accept" width="95px" text="Add" icon="sap-icon://add-process" tooltip="{i18n>NewOperation}" press=".createNewRowOperations"/>
														<Button type="Reject" width="95px" text="Delete" icon="sap-icon://delete" tooltip="{i18n>DeleteselectedOperations}"
															press=".deleteSelectedOperations"/>
													</content>
												</Toolbar>
											</table:toolbar>
											<table:columns>
												<table:Column width="4rem">
													<Label text="{i18n>OpAc}"/>
													<table:template>
														<Input editable="{jsonModel>New}" value="{path:'jsonModel>OperationID', type : 'pd.pm.lite.customTypes.Number' }"/>
													</table:template>
												</table:Column>
												<table:Column width="8rem">
													<Label text="{i18n>WorkCenter}"/>
													<table:template>
														<ComboBox showSecondaryValues="true" value="{path: 'jsonModel>WorkCenter', type : 'pd.pm.lite.customTypes.Mandatory'}"
															items="{path:'localStorageModel>/WorkCenters', templateShareable:false}">
															<core:ListItem text="{localStorageModel>Id}" key="{localStorageModel>Id}" additionalText="{localStorageModel>Name}"></core:ListItem>
														</ComboBox>
													</table:template>
												</table:Column>
												<table:Column hAlign="End">
													<Label text="{i18n>OpShortText}"/>
													<table:template>
														<Input value="{path: 'jsonModel>ShortText', type : 'pd.pm.lite.customTypes.Mandatory' }" maxLength="40"/>
													</table:template>
												</table:Column>
												<table:Column width="5rem">
													<Label text="{i18n>Work}"/>
													<table:template>
														<Input value="{path: 'jsonModel>WorkQuantity', type : 'pd.pm.lite.customTypes.Number'}"/>
													</table:template>
												</table:Column>
												<table:Column width="8rem">
													<Label text="{i18n>Unit}"/>
													<table:template>
														<ComboBox selectedKey="{path: 'jsonModel>WorkUnit', type : 'pd.pm.lite.customTypes.Mandatory'}">
															<core:ListItem text="Minutes" key="MIN"></core:ListItem>
															<core:ListItem text="Hours" key="H"></core:ListItem>
															<core:ListItem text="Days" key="DAY"></core:ListItem>
														</ComboBox>
													</table:template>
												</table:Column>
												<table:Column width="7rem">
													<Label text="{i18n>ActualWork}"/>
													<table:template>
														<Label text="{jsonModel>ActualWork}"/>
													</table:template>
												</table:Column>
											</table:columns>
										</table:Table>
									</VBox>
									<VBox height="50%" justifyContent="End">
										<table:Table id="ComponentsTable" rows="{path: 'jsonModel>/Components', templateShareable:false}" minAutoRowCount="9"
											visibleRowCountMode="Auto" class="sapUiTinyMarginBegin">
											<table:toolbar>
												<Toolbar class="cisTableHeader">
													<content>
														<Button width="100px" class="cisHeadingButton" text="Components"/>
														<Button type="Accept" width="90px" text="Add" icon="sap-icon://add-equipment" tooltip="{i18n>NewComponent}" press=".createNewRowComponents"/>
														<Button type="Reject" width="90px" text="Delete" icon="sap-icon://delete" tooltip="{i18n>DeleteselectedComponents}"
															press=".deleteSelectedComponents"/>
													</content>
												</Toolbar>
											</table:toolbar>
											<table:columns>
												<table:Column width="5rem">
													<Label text="{i18n>Item}"/>
													<table:template>
														<Input editable="{jsonModel>New}" value="{path:'jsonModel>ItemID', type : 'pd.pm.lite.customTypes.Number'}"/>
													</table:template>
												</table:Column>
												<table:Column width="9rem">
													<Label text="{i18n>Component}"/>
													<table:template>
														<Input showValueHelp="true" valueHelpRequest="showComponentValueHelp"
															value="{path: 'jsonModel>ComponentNumber', type : 'pd.pm.lite.customTypes.ComponentId'}" change=".getComponentDetail"/>
													</table:template>
												</table:Column>
												<table:Column hAlign="End">
													<Label text="{i18n>Description}"/>
													<table:template>
														<Label text="{jsonModel>Description}"/>
													</table:template>
												</table:Column>
												<table:Column width="5rem">
													<Label text="{i18n>ReqQuantity}"/>
													<table:template>
														<Input value="{ path: 'jsonModel>RequirementQuantity', type : 'pd.pm.lite.customTypes.Number'}"/>
													</table:template>
												</table:Column>
												<table:Column width="4rem">
													<Label text="{i18n>Unit}"/>
													<table:template>
														<Label text="{path: 'jsonModel>Unit'}"/>
													</table:template>
												</table:Column>
												<table:Column width="5rem">
													<Label text="{i18n>IC}"/>
													<table:template>
														<Label text="{jsonModel>ItemCategory}"/>
													</table:template>
												</table:Column>
												<table:Column width="7rem">
													<Label text="{i18n>OperationReference}"/>
													<table:template>
														<Input value="{path: 'jsonModel>OperationReference', type : 'pd.pm.lite.customTypes.Operation'}"/>
													</table:template>
												</table:Column>
											</table:columns>
										</table:Table>
									</VBox>
								</VBox>
								<VBox height="98%" width="40%" direction="Column" class="sapUiTinyMarginBegin pdForm" alignItems="End" justifyContent="{= ${jsonModel>/WorkOrderDetail/OrderType} === 'PM02'? 'Start':'SpaceBetween' }">
									<f:SimpleForm class="notificationBox" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout" title="Notification" labelSpanL="2"
										labelSpanM="2" emptySpanL="0" emptySpanM="0" columnsL="1" columnsM="1">
										<f:content>
											<Label text="{i18n>Code}" class="PDLabel"/>
											<ComboBox selectedKey="{jsonModel>/WorkOrderDetail/NotificationCode}" items="{path:'NotificationCodes', templateShareable:false}">
												<core:Item key="{Code}" text="{Name}"/>
											</ComboBox>
											<Label text="{i18n>Note}" class="PDLabel"/>
											<TextArea growing="true" rows="2" value="{jsonModel>/WorkOrderDetail/NewNote}"/>
											<Label text=""/>
											<FormattedText class="oldNotes" height="150px" htmlText="{jsonModel>/WorkOrderDetail/NotificationLongText}"></FormattedText>
											<!--<core:HTML class="oldNotes" content="{jsonModel>/WorkOrderDetail/NotificationLongText}"/>-->
										</f:content>
									</f:SimpleForm>
									<!--Operation Downtime (NPT)-->
									<f:SimpleForm class="notificationBox" visible="{= ${jsonModel>/WorkOrderDetail/OrderType} === 'PM01'}" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout"
										title="{i18n>OperationalDowntime} (NPT)" labelSpanL="2" labelSpanM="2" emptySpanL="0" emptySpanM="0" columnsL="1" columnsM="1">
										<f:content>
											<Label text="{i18n>DowntimeStart}" class="PDLabel"/>
											<DateTimePicker dateValue="{jsonModel>/WorkOrderDetail/DowntimeStart}" valueFormat="yyyy-MM-ddTHH:mm:ss" type="sap.ui.model.type.DateTime"
												displayFormat="short" displayFormatType="Gregorian"/>
											<CheckBox text="{i18n>OperationalDowntime}"/>
											<Label text="{i18n>DowntimeEnd}" class="PDLabel"/>
											<DateTimePicker dateValue="{jsonModel>/WorkOrderDetail/DowntimeEnd}" valueFormat="yyyy-MM-ddTHH:mm:ss" type="sap.ui.model.type.DateTime"
												displayFormat="short" displayFormatType="Gregorian"/>
											<Text
												text="{parts:[{path: 'i18n>OperationalDowntime'}, {path: 'jsonModel>/WorkOrderDetail/DowntimeStart'}, {path: 'jsonModel>/WorkOrderDetail/DowntimeEnd'}], formatter: '.formatter.duration'}"
												class="PDLabel"/>
										</f:content>
									</f:SimpleForm>
									<!--Malfunction Data-->
									<f:SimpleForm class="notificationBox" visible="{= ${jsonModel>/WorkOrderDetail/OrderType} === 'PM01'}" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout" title="{i18n>MalfunctionData}"
										labelSpanL="2" labelSpanM="2" emptySpanL="0" emptySpanM="0" columnsL="1" columnsM="1">
										<f:content>
											<Label text="{i18n>BreakdownStart}" class="PDLabel"/>
											<DateTimePicker dateValue="{jsonModel>/WorkOrderDetail/BreakdownStart}" valueFormat="yyyy-MM-ddTHH:mm:ss"
												type="sap.ui.model.type.DateTime" displayFormat="short" displayFormatType="Gregorian"/>
											<CheckBox text="{i18n>Breakdown}"/>
											<Label text="{i18n>BreakdownEnd}" class="PDLabel"/>
											<DateTimePicker dateValue="{jsonModel>/WorkOrderDetail/BreakdownFinish}" valueFormat="yyyy-MM-ddTHH:mm:ss"
												type="sap.ui.model.type.DateTime" displayFormat="short" displayFormatType="Gregorian"/>
											<Text
												text="{parts:[{path: 'i18n>BreakdownDur'}, {path: 'jsonModel>/WorkOrderDetail/BreakdownStart'}, {path: 'jsonModel>/WorkOrderDetail/BreakdownFinish'}], formatter: '.formatter.duration'}"
												class="PDLabel"/>
										</f:content>
									</f:SimpleForm>
									<f:SimpleForm class="notificationBox" maxContainerCols="2" editable="false" layout="ResponsiveGridLayout" title="Failure Data"
										labelSpanL="2" labelSpanM="2" emptySpanL="0" emptySpanM="0" columnsL="1" columnsM="1">
										<f:content>
											<Label text="{i18n>Damage}" class="PDLabel"/>
											<ComboBox showSecondaryValues="true" selectedKey="{jsonModel>/WorkOrderDetail/Damage/DamageCodeGroup}" items="{DamageCodeGroups}"
												selectionChange=".getValidDamageCodes">
												<core:ListItem key="{CodeGroup}" text="{CodeGroup}" additionalText="{Name}"/>
											</ComboBox>
											<ComboBox showSecondaryValues="true" selectedKey="{jsonModel>/WorkOrderDetail/Damage/DamageCode}" items="{DamageCodes}">
												<core:ListItem key="{Code}" text="{Code}" additionalText="{Name}"/>
											</ComboBox>
											<Label text="{i18n>Text}" class="PDLabel"/>
											<Input value="{jsonModel>/WorkOrderDetail/Damage/DamageText}" maxLength="40"/>
											<Label text="{i18n>CauseCode}" class="PDLabel"/>
											<ComboBox showSecondaryValues="true" selectedKey="{jsonModel>/WorkOrderDetail/Cause/CauseCodeGroup}" items="{CauseCodeGroups}"
												selectionChange=".getValidCauseCodes">
												<core:ListItem key="{CodeGroup}" text="{CodeGroup}" additionalText="{Name}"/>
											</ComboBox>
											<ComboBox showSecondaryValues="true" selectedKey="{jsonModel>/WorkOrderDetail/Cause/CauseCode}" items="{CauseCodes}">
												<core:ListItem key="{Code}" text="{Code}" additionalText="{Name}"/>
											</ComboBox>
											<Label text="{i18n>Text}" class="PDLabel"/>
											<Input value="{jsonModel>/WorkOrderDetail/Cause/CauseText}" maxLength="40"/>
										</f:content>
									</f:SimpleForm>
								</VBox>
							</HBox>
						</VBox>
					</HBox>
				</content>
				<dependents>
					<core:Fragment fragmentName="pd.pm.lite.view.WorkCenterDialog" type="XML"/>
					<core:Fragment fragmentName="pd.pm.lite.view.ComponentDialog" type="XML"/>
					<core:Fragment fragmentName="pd.pm.lite.view.UserStatusDialog" type="XML"/>					
				</dependents>
			</Page>
		</pages>
	</App>
	<BusyDialog id="ChangeBusyDialog"/>
</mvc:View>